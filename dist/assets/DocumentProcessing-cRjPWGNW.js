import{r as l,j as e,I as a}from"./index-zf_QIKpT.js";import{s as f}from"./storage-CH_An79i.js";function P(){var y,v;const[n,b]=l.useState([]),[g,S]=l.useState([]),[c,C]=l.useState(""),[m,D]=l.useState(""),[u,w]=l.useState(""),[r,d]=l.useState(null);l.useEffect(()=>{h()},[]),l.useEffect(()=>{B()},[n,c,m,u]);function h(){const t=f.getDocuments();b(t)}function B(){let t=[...n];if(c&&(t=t.filter(s=>s.status===c)),m&&(t=t.filter(s=>{var i;return((i=s.meta)==null?void 0:i.category)===m})),u.trim()){const s=u.toLowerCase();t=t.filter(i=>i.name.toLowerCase().includes(s)||i.id.toLowerCase().includes(s))}S(t)}function p(t,s){f.updateDocument(t,{status:s}),h()}function k(t){const s={submitted:{bg:"#DBEAFE",color:"#1E40AF",text:"Submitted"},processing:{bg:"#FEF3C7",color:"#92400E",text:"Processing"},processed:{bg:"#D1FAE5",color:"#065F46",text:"Processed"},rejected:{bg:"#FEE2E2",color:"#991B1B",text:"Rejected"}},i=s[t]||s.submitted;return e.jsx("span",{style:{background:i.bg,color:i.color,padding:"0.25rem 0.75rem",borderRadius:"999px",fontSize:"0.75rem",fontWeight:"600"},children:i.text})}const x={submitted:n.filter(t=>t.status==="submitted").length,processing:n.filter(t=>t.status==="processing").length,processed:n.filter(t=>t.status==="processed").length,rejected:n.filter(t=>t.status==="rejected").length},j=[{value:"general",label:"General Document"},{value:"id",label:"ID Document"},{value:"proof-address",label:"Proof of Address"},{value:"application",label:"Application Form"},{value:"rates",label:"Rates & Taxes"},{value:"permit",label:"Permit/License"}];return e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"Document Processing"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#1E40AF"},children:x.submitted}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Submitted"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#F59E0B"},children:x.processing}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Processing"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#10B981"},children:x.processed}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Processed"})]}),e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"1.5rem"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#EF4444"},children:x.rejected}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:"Rejected"})]})]}),e.jsxs("div",{className:"document-actions",style:{display:"flex",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("button",{className:"action-btn secondary",onClick:h,children:[e.jsx(a,{name:"Dashboard"}),"Refresh"]}),e.jsxs("button",{className:"action-btn secondary",onClick:()=>{n.filter(s=>s.status==="submitted").forEach(s=>p(s.id,"processing"))},children:[e.jsx(a,{name:"Document"}),"Batch Process All"]})]}),e.jsxs("section",{className:"document-queue card",children:[e.jsxs("h2",{style:{marginBottom:"1rem"},children:["Document Queue (",g.length,")"]}),e.jsxs("div",{className:"document-filters",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Status"}),e.jsxs("select",{className:"filter-dropdown",value:c,onChange:t=>C(t.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"processed",children:"Processed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Category"}),e.jsxs("select",{className:"filter-dropdown",value:m,onChange:t=>D(t.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"",children:"All Categories"}),j.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.875rem",fontWeight:"600"},children:"Search"}),e.jsx("input",{type:"search",placeholder:"Search by name or ID...",className:"search-input",value:u,onChange:t=>w(t.target.value),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"}})]})]}),e.jsx("div",{className:"documents-list",children:g.length===0?e.jsxs("div",{style:{textAlign:"center",padding:"3rem 1rem",color:"var(--text-secondary)"},children:[e.jsx(a,{name:"Document",size:48,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{children:"No documents found matching your criteria."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:g.map(t=>{var s,i;return e.jsx("div",{className:"document-item",style:{padding:"1rem",background:"var(--light)",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s"},onClick:()=>d(t),children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsx(a,{name:"Document",style:{flexShrink:0}}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"doc-title",style:{fontWeight:"600",marginBottom:"0.25rem"},children:t.name}),e.jsxs("div",{className:"text-muted",style:{fontSize:"0.875rem"},children:["ID: ",t.id," • ",new Date(t.createdAt).toLocaleString()," • ",Math.round(t.size/1024)," KB",((s=t.meta)==null?void 0:s.category)&&` • ${((i=j.find(o=>o.value===t.meta.category))==null?void 0:i.label)||t.meta.category}`]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[k(t.status),e.jsxs("select",{value:t.status,onChange:o=>{o.stopPropagation(),p(t.id,o.target.value)},style:{fontSize:"0.75rem",padding:"0.25rem 0.5rem",borderRadius:"4px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"processed",children:"Processed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]}),t.dataUrl&&e.jsx("button",{className:"view-all",onClick:o=>{o.stopPropagation(),window.open(t.dataUrl)},style:{padding:"0.5rem 1rem",fontSize:"0.875rem"},children:"View"})]})]})},t.id)})})})]}),r&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},onClick:()=>d(null),children:e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"8px",maxWidth:"800px",width:"100%",maxHeight:"90vh",overflow:"auto"},onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("h2",{style:{marginBottom:"0.5rem"},children:r.name}),e.jsxs("div",{style:{fontSize:"0.875rem",color:"var(--text-secondary)"},children:["Document ID: ",r.id]})]}),e.jsx("button",{onClick:()=>d(null),style:{background:"transparent",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"var(--muted)"},children:"✕"})]}),e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Submitted:"}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:new Date(r.createdAt).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Category:"}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:((y=j.find(t=>{var s;return t.value===((s=r.meta)==null?void 0:s.category)}))==null?void 0:y.label)||"General"})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Size:"}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:[(r.size/1024).toFixed(2)," KB"]})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Type:"}),e.jsx("div",{style:{color:"var(--text-secondary)"},children:r.type||"Unknown"})]})]})}),e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("strong",{style:{display:"block",marginBottom:"0.5rem"},children:"Status:"}),e.jsxs("select",{value:r.status,onChange:t=>{p(r.id,t.target.value),d({...r,status:t.target.value})},style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"processing",children:"Processing"}),e.jsx("option",{value:"processed",children:"Processed"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]}),r.dataUrl&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsx("strong",{style:{display:"block",marginBottom:"0.5rem"},children:"Preview:"}),e.jsx("div",{style:{border:"1px solid var(--muted)",borderRadius:"6px",overflow:"hidden",maxHeight:"400px"},children:(v=r.type)!=null&&v.startsWith("image/")?e.jsx("img",{src:r.dataUrl,alt:r.name,style:{width:"100%",height:"auto"}}):e.jsxs("div",{style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:[e.jsx(a,{name:"Document",size:48,style:{opacity:.3,marginBottom:"1rem"}}),e.jsx("p",{children:"Preview not available for this file type"})]})})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[r.dataUrl&&e.jsxs("button",{className:"action-btn secondary",onClick:()=>window.open(r.dataUrl),children:[e.jsx(a,{name:"Document",size:16}),"Open Full View"]}),e.jsx("button",{className:"action-btn",onClick:()=>d(null),children:"Close"})]})]})})]})}export{P as default};
