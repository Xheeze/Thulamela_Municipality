import{r as o,j as e,I as l}from"./index-zf_QIKpT.js";import{s as d}from"./storage-CH_An79i.js";import{L as y}from"./LiveQueue-eysH4lk3.js";function S(){const[u,c]=o.useState(0);function n(){let r={nowServing:"A092",next:["A093","A094","A095"],counter:"Counter 3"};try{const i=d.getQueueState();i&&typeof i=="object"&&i.nowServing&&Array.isArray(i.next)&&(r=i)}catch{}return r}const[s,a]=o.useState(n());o.useEffect(()=>{a(n());const t=setInterval(()=>{a(n())},5e3);return()=>clearInterval(t)},[u]);function x(){d.callNext(),a(n()),c(t=>t+1)}function h(){const t=p();d.addToQueue(t),a(n()),c(r=>r+1)}function g(){const t=n();if(t.next&&t.next.length>0){const r=t.nowServing;d.addToQueue(r),x()}}function p(){const t=n(),r=[t.nowServing,...t.next].filter(Boolean);if(r.length===0)return"A001";const i=r.map(j=>{const m=j.match(/(\d+)$/);return m?parseInt(m[1]):0});return`A${(Math.max(...i)+1).toString().padStart(3,"0")}`}return e.jsx("div",{className:"staff-page",children:e.jsxs("div",{className:"container",children:[e.jsx("h1",{style:{color:"var(--primary)"},children:"Queue Management"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",margin:"1rem 0",flexWrap:"wrap"},children:[e.jsxs("button",{className:"action-btn",onClick:x,children:[e.jsx(l,{name:"Queue"})," Call Next"]}),e.jsxs("button",{className:"action-btn",onClick:h,children:[e.jsx(l,{name:"Upload"})," Add Ticket"]}),e.jsxs("button",{className:"action-btn secondary",onClick:g,children:[e.jsx(l,{name:"Calendar"})," Skip Current"]}),e.jsxs("button",{className:"action-btn secondary",onClick:()=>c(t=>t+1),children:[e.jsx(l,{name:"Settings"})," Refresh"]})]}),e.jsx("section",{style:{marginBottom:"2rem"},children:e.jsx(y,{})}),e.jsxs("section",{className:"card",style:{marginBottom:"1rem"},children:[e.jsx("h2",{children:"Current Queue"}),e.jsxs("div",{style:{display:"flex",gap:"1rem",marginTop:"1rem"},children:[e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"1rem",background:"var(--light)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--primary)"},children:Array.isArray(s.next)?s.next.length:0}),e.jsx("div",{className:"text-muted",children:"Waiting"})]}),e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"1rem",background:"var(--light)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--primary)"},children:"--"}),e.jsx("div",{className:"text-muted",children:"Avg Wait"})]}),e.jsxs("div",{style:{flex:1,textAlign:"center",padding:"1rem",background:"var(--light)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"1.75rem",fontWeight:700,color:"var(--primary)"},children:s.nowServing||"-"}),e.jsx("div",{className:"text-muted",children:"Current"})]})]}),e.jsx("div",{className:"preview-list",style:{marginTop:"1rem"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--light)"},children:[e.jsx("th",{style:{textAlign:"left",padding:"0.75rem"},children:"Number"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem"},children:"Time"}),e.jsx("th",{style:{textAlign:"left",padding:"0.75rem"},children:"Status"})]})}),e.jsx("tbody",{children:Array.isArray(s.next)&&s.next.length>0?s.next.map((t,r)=>e.jsxs("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.04)"},children:[e.jsx("td",{style:{padding:"0.75rem"},children:t}),e.jsx("td",{style:{padding:"0.75rem"},children:"--"}),e.jsx("td",{style:{padding:"0.75rem"},children:"Waiting"})]},r)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,style:{padding:"0.75rem",textAlign:"center",color:"#888"},children:"No one waiting"})})})]})})]}),e.jsxs("section",{className:"card",children:[e.jsx("h2",{children:"Service Points"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginTop:"1rem"},children:e.jsxs("div",{style:{background:"var(--light)",padding:"1rem",borderRadius:"8px"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:"0.5rem"},children:[e.jsx("span",{className:"doc-title",children:"Counter 1"}),e.jsx("span",{style:{background:"#DCFCE7",padding:"0.25rem 0.5rem",borderRadius:"999px",color:"#14532D",fontSize:"0.75rem"},children:"Active"})]}),e.jsxs("div",{className:"text-muted",children:["Currently serving: ",s.nowServing||"-"]})]})})]})]})})}export{S as default};
