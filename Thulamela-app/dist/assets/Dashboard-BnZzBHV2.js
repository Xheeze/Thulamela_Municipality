import{u as N,r as d,j as e,I as l}from"./index-CMLaGl6O.js";import{s as u}from"./storage-CH_An79i.js";import{L as w}from"./LiveQueue-DJsiSax7.js";function B(){const g=N(),[p,x]=d.useState(0),[j,m]=d.useState(!1),[s,a]=d.useState({title:"",description:"",assignedTo:"",priority:"medium",dueDate:"",category:"general"});function o(){let n={nowServing:"A092",next:["A093","A094","A095"],counter:"Counter 3"};try{const r=u.getQueueState();r&&typeof r=="object"&&r.nowServing&&Array.isArray(r.next)&&(n=r)}catch{}return n}const[i,c]=d.useState(o());d.useEffect(()=>{c(o());const t=setInterval(()=>{c(o())},5e3);return()=>clearInterval(t)},[p]);function v(){u.callNext(),c(o()),x(t=>t+1)}function y(){const t=f();u.addToQueue(t),c(o()),x(n=>n+1)}function f(){const t=o(),n=[t.nowServing,...t.next].filter(Boolean);if(n.length===0)return"A001";const r=n.map(k=>{const h=k.match(/(\d+)$/);return h?parseInt(h[1]):0});return`A${(Math.max(...r)+1).toString().padStart(3,"0")}`}function b(t){t.preventDefault(),s.title.trim()&&(u.saveTask(s),m(!1),a({title:"",description:"",assignedTo:"",priority:"medium",dueDate:"",category:"general"}))}return e.jsxs("div",{className:"page",children:[e.jsx("h1",{children:"Staff Dashboard"}),e.jsxs("div",{className:"kpi-grid staff-kpis",children:[e.jsxs("div",{className:"kpi-card",children:[e.jsx(l,{name:"Ticket"}),e.jsx("div",{className:"kpi-value",children:Array.isArray(i.next)?i.next.length:0}),e.jsx("div",{className:"kpi-label",children:"Tickets in Queue"})]}),e.jsxs("div",{className:"kpi-card",children:[e.jsx(l,{name:"Document"}),e.jsx("div",{className:"kpi-value",children:12}),e.jsx("div",{className:"kpi-label",children:"Pending Documents"})]}),e.jsxs("div",{className:"kpi-card",children:[e.jsx(l,{name:"Queue"}),e.jsx("div",{className:"kpi-value",children:i.nowServing||""}),e.jsx("div",{className:"kpi-label",children:"Now Serving"})]})]}),e.jsxs("section",{className:"quick-actions",style:{marginTop:"1rem"},children:[e.jsxs("button",{className:"action-btn",onClick:y,children:[e.jsx(l,{name:"Upload"}),"New Ticket"]}),e.jsxs("button",{className:"action-btn",onClick:v,children:[e.jsx(l,{name:"Queue"}),"Call Next"]}),e.jsxs("button",{className:"action-btn",onClick:()=>g("/staff/queue"),children:[e.jsx(l,{name:"Settings"}),"Queue Management"]}),e.jsxs("button",{className:"action-btn secondary",onClick:()=>m(!0),children:[e.jsx(l,{name:"Document"}),"Create Task"]})]}),e.jsx("section",{style:{marginTop:"2rem"},children:e.jsx(w,{})}),e.jsxs("section",{className:"queue-preview",children:[e.jsx("h2",{children:"Current Queue"}),e.jsxs("div",{className:"card",style:{marginTop:"0.5rem"},children:[e.jsxs("div",{style:{marginBottom:"0.5rem"},children:["Now Serving: ",e.jsxs("strong",{children:[i.nowServing||"-"," "]})]}),e.jsxs("div",{children:["Next: ",Array.isArray(i.next)&&i.next.length?i.next.join(", "):"No one waiting"]})]})]}),j&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",padding:"2rem",borderRadius:"8px",maxWidth:"500px",width:"90%",maxHeight:"90vh",overflow:"auto"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem"},children:"Create New Task"}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Title *"}),e.jsx("input",{type:"text",value:s.title,onChange:t=>a({...s,title:t.target.value}),required:!0,style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"}})]}),e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Description"}),e.jsx("textarea",{value:s.description,onChange:t=>a({...s,description:t.target.value}),rows:3,style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Priority"}),e.jsxs("select",{value:s.priority,onChange:t=>a({...s,priority:t.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Category"}),e.jsxs("select",{value:s.category,onChange:t=>a({...s,category:t.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"},children:[e.jsx("option",{value:"general",children:"General"}),e.jsx("option",{value:"document",children:"Document Processing"}),e.jsx("option",{value:"queue",children:"Queue Management"}),e.jsx("option",{value:"maintenance",children:"Maintenance"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Assigned To"}),e.jsx("input",{type:"text",value:s.assignedTo,onChange:t=>a({...s,assignedTo:t.target.value}),placeholder:"Staff member name",style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600"},children:"Due Date"}),e.jsx("input",{type:"date",value:s.dueDate,onChange:t=>a({...s,dueDate:t.target.value}),style:{width:"100%",padding:"0.5rem",borderRadius:"6px",border:"1px solid var(--muted)"}})]})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"action-btn secondary",children:"Cancel"}),e.jsx("button",{type:"submit",className:"action-btn",children:"Create Task"})]})]})]})})]})}export{B as default};
