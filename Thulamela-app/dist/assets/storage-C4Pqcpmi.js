const r={DOCUMENTS:"digiserve:documents",APPOINTMENTS:"digiserve:appointments",PROFILE:"digiserve:profile",FEEDBACK:"digiserve:feedback",QUEUE:"digiserve:queue"};function u(e,n=[]){try{const t=localStorage.getItem(e);return t?JSON.parse(t):n}catch(t){return console.error("storage read error",t),n}}function c(e,n){try{localStorage.setItem(e,JSON.stringify(n))}catch(t){console.error("storage write error",t)}}function f(e=""){return e+Date.now().toString(36)+"-"+Math.random().toString(36).slice(2,9)}function S(){return u(r.DOCUMENTS,[])}function p({name:e,size:n,type:t,dataUrl:o=null,meta:s={}}){const i=S(),a={id:f("doc_"),name:e,size:n,type:t,dataUrl:o,meta:s,status:"submitted",createdAt:new Date().toISOString()};return i.unshift(a),c(r.DOCUMENTS,i),a}function A(e,n){const t=S(),o=t.findIndex(s=>s.id===e);return o===-1?null:(t[o]={...t[o],...n},c(r.DOCUMENTS,t),t[o])}function g(){return u(r.APPOINTMENTS,[])}function m({service:e,date:n,time:t,name:o,contact:s}){const i=g();if(i.find(d=>d.service===e&&d.date===n&&d.time===t))throw new Error("Slot already booked");const E={id:f("appt_"),service:e,date:n,time:t,name:o,contact:s,status:"scheduled",createdAt:new Date().toISOString()};return i.push(E),c(r.APPOINTMENTS,i),E}function O(e){let n=g();n=n.map(t=>t.id===e?{...t,status:"cancelled"}:t),c(r.APPOINTMENTS,n)}function D(){return u(r.PROFILE,null)}function N(e){return c(r.PROFILE,e),e}function l(){return u(r.FEEDBACK,[])}function I({category:e,message:n,name:t,contact:o}){const s=l(),i={id:f("fb_"),category:e,message:n,name:t,contact:o,createdAt:new Date().toISOString()};return s.unshift(i),c(r.FEEDBACK,s),i}function P(){return u(r.QUEUE,{nowServing:"A092",next:["A093","A094","A095"],counter:"Counter 3"})}const T={getDocuments:S,saveDocument:p,updateDocument:A,getAppointments:g,saveAppointment:m,cancelAppointment:O,getProfile:D,saveProfile:N,getFeedback:l,saveFeedback:I,getQueue:P};export{T as s};
