import{r as l,j as e}from"./index-CMLaGl6O.js";import{s as g}from"./storage-CH_An79i.js";function f(i=5e3){var a,m;const[n,r]=l.useState(o()),[x,u]=l.useState(new Date);function o(){try{const t=g.getQueueState();if(t&&typeof t=="object"&&t.nowServing)return t}catch(t){console.error("Error getting queue state:",t)}return{nowServing:"A092",next:["A093","A094","A095"],counter:"Counter 3"}}function s(){const t=o();return r(t),u(new Date),t}function c(){try{return g.callNext(),s()}catch(t){return console.error("Error calling next:",t),n}}function d(t){try{return g.addToQueue(t),s()}catch(p){return console.error("Error adding to queue:",p),n}}return l.useEffect(()=>{if(s(),i>0){const t=setInterval(()=>{s()},i);return()=>clearInterval(t)}},[i]),{queue:n,lastUpdate:x,refreshQueue:s,callNext:c,addToQueue:d,waitingCount:((a=n.next)==null?void 0:a.length)||0,estimatedWait:(((m=n.next)==null?void 0:m.length)||0)*3}}function j({refreshInterval:i=5e3,showControls:n=!1}){const{queue:r,lastUpdate:x,waitingCount:u,estimatedWait:o,refreshQueue:s}=f(i),[c,d]=l.useState(!1);return l.useEffect(()=>{d(!0);const a=setTimeout(()=>d(!1),300);return()=>clearTimeout(a)},[r.nowServing,u]),e.jsxs("section",{className:"live-queue",style:{transition:"all 0.3s ease",transform:c?"scale(0.99)":"scale(1)",opacity:c?.9:1},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"var(--space-lg)",flexWrap:"wrap",gap:"0.5rem"},children:[e.jsx("h2",{style:{margin:0},children:"Live Queue Status"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--muted)",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("span",{style:{width:"8px",height:"8px",borderRadius:"50%",background:"#10B981",display:"inline-block",animation:"pulse 2s infinite"}}),"Updated ",x.toLocaleTimeString()]}),n&&e.jsx("button",{onClick:s,style:{background:"transparent",border:"1px solid var(--muted)",borderRadius:"4px",padding:"0.25rem 0.5rem",fontSize:"0.75rem",cursor:"pointer",color:"var(--text-primary)"},title:"Refresh now",children:"â†» Refresh"})]})]}),e.jsxs("div",{className:"queue-grid",children:[e.jsxs("div",{className:"queue-card",children:[e.jsx("div",{className:"card-label",children:"Now Serving"}),e.jsx("div",{className:"ticket-number",children:r.nowServing||"-"}),e.jsxs("div",{className:"queue-info",children:["Estimated wait: ",o," mins"]})]}),e.jsxs("div",{className:"queue-card",children:[e.jsx("div",{className:"card-label",children:"Next Numbers"}),e.jsx("div",{className:"next-numbers",children:r.next&&r.next.length>0?r.next.slice(0,3).map((a,m)=>e.jsx("div",{className:"next-ticket",children:a},m)):e.jsx("div",{style:{color:"var(--muted)",fontSize:"0.875rem"},children:"No one waiting"})}),e.jsx("div",{className:"queue-info",children:u>0?e.jsxs(e.Fragment,{children:["People waiting: ",u]}):e.jsxs(e.Fragment,{children:["Currently serving: ",r.counter||"Counter 1"]})})]})]})]})}export{j as L};
